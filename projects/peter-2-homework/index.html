<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ” ç°¡å–®è¨˜å¸³æœ¬ï¼ˆå«åˆ†é¡ï¼‰</title>
<style>
  body {
    font-family: "Microsoft JhengHei", sans-serif;
    background: #fdf6ec;
    text-align: center;
    margin: 0;
    padding: 1rem;
  }
  h1 { margin: 1rem 0; }

  /* æ¼¢å ¡çµæ§‹ */
  .burger {
    max-width: 420px;
    margin: auto;
  }
  .bun-top, .bun-bottom {
    background: #f4a261;
    border-radius: 50%;
    height: 60px;
    margin: 0 auto;
    width: 90%;
  }
  .bun-top { border-bottom-left-radius: 60px; border-bottom-right-radius: 60px; }
  .bun-bottom { border-top-left-radius: 60px; border-top-right-radius: 60px; height: 50px; }

  .patty {
    background: #6a4e42;
    margin: 0.5rem auto;
    padding: 1rem;
    border-radius: 15px;
    color: white;
  }
  .cheese {
    background: #fcd34d;
    margin: 0.5rem auto;
    padding: 0.5rem;
    border-radius: 10px;
  }
  .lettuce {
    background: #81c784;
    margin: 0.5rem auto;
    padding: 0.5rem;
    border-radius: 10px;
  }

  input, select, button {
    padding: 0.5rem;
    margin: 0.2rem;
    border-radius: 6px;
    border: 1px solid #ccc;
  }
  button {
    background: #2a9d8f;
    color: white;
    border: none;
    cursor: pointer;
  }
  button:hover { background: #21867a; }
  ul { list-style: none; padding: 0; margin: 0.5rem 0; }
  li { padding: 0.3rem; border-bottom: 1px dashed #eee; font-size: 0.9rem; }
  .category-total {
    font-size: 0.85rem;
    margin: 0.2rem 0;
  }
</style>
</head>
<body>
  <h1>ğŸ” ç°¡å–®è¨˜å¸³æœ¬</h1>
  <div class="burger">
    <div class="bun-top"></div>

    <!-- è¼¸å…¥å€ (ç”Ÿèœå±¤) -->
    <div class="lettuce">
      <input type="text" id="item" placeholder="é …ç›®">
      <input type="number" id="amount" placeholder="é‡‘é¡">
      <select id="category">
        <option value="é¤é£²">é¤é£²</option>
        <option value="äº¤é€š">äº¤é€š</option>
        <option value="å¨›æ¨‚">å¨›æ¨‚</option>
        <option value="å…¶ä»–">å…¶ä»–</option>
      </select>
      <button onclick="addExpense()">æ–°å¢</button>
    </div>

    <!-- ç´€éŒ„æ¸…å–® (èµ·å¸å±¤) -->
    <div class="cheese">
      <h3>ç´€éŒ„</h3>
      <ul id="list"></ul>
    </div>

    <!-- ç´¯è¨ˆé¡¯ç¤º (è‚‰æ’å±¤) -->
    <div class="patty">
      <h3>ç´¯è¨ˆ</h3>
      <p>ä»Šæ—¥ï¼š<span id="dailyTotal">0</span></p>
      <p>æœ¬å‘¨ï¼š<span id="weeklyTotal">0</span></p>
      <p>æœ¬æœˆï¼š<span id="monthlyTotal">0</span></p>
      <h4>åˆ†é¡å°è¨ˆ</h4>
      <div id="categoryTotals"></div>
    </div>

    <div class="bun-bottom"></div>
  </div>

<script>
  let expenses = JSON.parse(localStorage.getItem("expenses_with_category") || "[]");

  function addExpense() {
    const item = document.getElementById("item").value.trim();
    const amount = parseFloat(document.getElementById("amount").value);
    const category = document.getElementById("category").value;
    if (!item || isNaN(amount)) return alert("è«‹è¼¸å…¥å®Œæ•´è³‡è¨Š");
    const date = new Date().toISOString();
    expenses.push({ item, amount, category, date });
    localStorage.setItem("expenses_with_category", JSON.stringify(expenses));
    document.getElementById("item").value = "";
    document.getElementById("amount").value = "";
    render();
  }

  function render() {
    const list = document.getElementById("list");
    list.innerHTML = "";
    let daily = 0, weekly = 0, monthly = 0;
    let categoryTotals = { "é¤é£²": 0, "äº¤é€š": 0, "å¨›æ¨‚": 0, "å…¶ä»–": 0 };
    const now = new Date();
    const todayStr = now.toISOString().slice(0,10);
    const startOfWeek = new Date(now); 
    startOfWeek.setDate(now.getDate() - now.getDay() + 1); // é€±ä¸€
    const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);

    expenses.forEach(e => {
      const d = new Date(e.date);
      const li = document.createElement("li");
      li.textContent = `${d.toLocaleDateString()} - [${e.category}] ${e.item}: $${e.amount}`;
      list.appendChild(li);

      if (e.date.slice(0,10) === todayStr) daily += e.amount;
      if (d >= startOfWeek) weekly += e.amount;
      if (d >= startOfMonth) monthly += e.amount;

      categoryTotals[e.category] += e.amount;
    });

    document.getElementById("dailyTotal").textContent = daily;
    document.getElementById("weeklyTotal").textContent = weekly;
    document.getElementById("monthlyTotal").textContent = monthly;

    const catDiv = document.getElementById("categoryTotals");
    catDiv.innerHTML = "";
    Object.keys(categoryTotals).forEach(cat => {
      const p = document.createElement("p");
      p.className = "category-total";
      p.textContent = `${cat}: $${categoryTotals[cat]}`;
      catDiv.appendChild(p);
    });
  }

  render();
</script>
</body>
</html>
