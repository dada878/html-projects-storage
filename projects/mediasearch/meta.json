{
  "projectName": "mediasearch",
  "authorName": "Maggie",
  "htmlContent": "<!doctype html>\n<html lang=\"zh-Hant\">\n<head>\n<meta charset=\"utf-8\" />\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n<title>Media Search · Zen</title>\n<style>\n  :root{\n    --bg-start:#0b1220; /* 深藍靛 */\n    --bg-end:#03060c;   /* 近黑 */\n    --ink:#eaeef6;      /* 主字色 */\n    --muted:#a9b3c7;\n    --accent:#c9b07a;   /* Zenbook 金銅 */\n    --accent-2:#7e6a48;\n    --card:#0e1726cc;   /* 玻璃感 */\n    --stroke:#1e2a41;\n    --ok:#86efac;\n    --warn:#fde68a;\n  }\n  *{box-sizing:border-box}\n  html,body{height:100%}\n  body{\n    margin:0;\n    color:var(--ink);\n    background:\n      radial-gradient(1000px 600px at 80% 10%, #22304b55 0%, transparent 60%),\n      radial-gradient(800px 500px at 10% 80%, #1a224033 0%, transparent 60%),\n      linear-gradient(140deg, var(--bg-start), var(--bg-end));\n    font-family: ui-sans-serif, system-ui, -apple-system, \"Segoe UI\", Roboto, \"Noto Sans TC\", \"Microsoft JhengHei\", Arial, \"PingFang TC\", sans-serif;\n    letter-spacing:.2px;\n  }\n  .wrap{max-width:980px;margin:0 auto;padding:28px 20px 64px}\n  header{\n    display:flex;align-items:center;justify-content:space-between;gap:12px;margin:8px 0 20px\n  }\n  .brand{\n    display:flex;align-items:center;gap:12px;\n  }\n  .badge{\n    width:42px;height:42px;border-radius:12px;\n    background: conic-gradient(from 200deg at 50% 50%, #2a3a57, #0f172a 40%, #2a3a57 70%, #0f172a);\n    border:1px solid #2b3752;\n    box-shadow: 0 8px 24px #00000040, inset 0 1px 0 #ffffff08;\n  }\n  h1{font-size:22px;margin:0;font-weight:650;letter-spacing:.4px}\n  .sub{color:var(--muted);font-size:13px;margin-top:2px}\n  .card{\n    background:var(--card); backdrop-filter: blur(10px);\n    border:1px solid var(--stroke); border-radius:18px;\n    box-shadow: 0 10px 30px #00000055, inset 0 1px 0 #ffffff08;\n    padding:18px;\n  }\n  .grid{display:grid;gap:14px}\n  @media(min-width:780px){ .grid-2{grid-template-columns:1.2fr .8fr} }\n  label{display:block;font-size:13px;color:var(--muted);margin:2px 0 8px}\n  input[type=\"text\"], input[type=\"date\"], textarea{\n    width:100%; background:#0b1322; color:var(--ink);\n    border:1px solid #1e2a41; border-radius:12px; padding:12px 14px; outline:none;\n    transition: border-color .2s, box-shadow .2s;\n  }\n  textarea{min-height:88px;resize:vertical}\n  input:focus, textarea:focus{border-color:#32466f; box-shadow:0 0 0 3px #4b6aa61f}\n  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}\n  .sites{\n    display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;margin-top:6px;max-height:220px;overflow:auto;padding-right:4px\n  }\n  .chip{\n    display:flex;align-items:center;gap:8px;padding:10px 12px;border:1px solid #21304f;border-radius:12px;background:#0b1322;\n    font-size:13px;color:#c9d2e7\n  }\n  .chip input{accent-color:var(--accent)}\n  .hint{font-size:12px;color:var(--muted)}\n  .btns{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}\n  .btn{\n    appearance:none;border:1px solid #2b3755;background:\n      linear-gradient(180deg,#142137,#0a1322);\n    color:var(--ink); padding:11px 14px;border-radius:12px;cursor:pointer;\n    font-weight:600;font-size:14px; letter-spacing:.2px;\n    transition: transform .08s ease, box-shadow .2s, border-color .2s;\n    box-shadow: 0 6px 18px #00000055, inset 0 1px 0 #ffffff10;\n  }\n  .btn:hover{border-color:#445a86; box-shadow:0 8px 24px #00000066}\n  .btn:active{transform:translateY(1px)}\n  .btn.primary{\n    background: linear-gradient(180deg,#2d2a1f,#0f0c07);\n    border-color:#5f5130;\n    box-shadow:0 10px 28px #00000077, inset 0 1px 0 #ffffff10;\n  }\n  .btn.primary .dot{\n    width:8px;height:8px;border-radius:50%;margin-left:8px;background:\n      radial-gradient(circle at 40% 40%, #fff, #ffe6b0 40%, #c9b07a 60%, #7e6a48);\n    box-shadow:0 0 6px #f9e3a8aa, 0 0 18px #f1d28755;\n    display:inline-block;vertical-align:middle\n  }\n  .divider{height:1px;background:linear-gradient(90deg,transparent,#23314f,transparent);margin:18px 0}\n  .result{display:grid;gap:10px;margin-top:10px}\n  .item{\n    padding:12px 12px 12px 14px; border:1px solid #23314f; border-radius:12px;\n    background:#0b1322; transition:border-color .2s\n  }\n  .item:hover{border-color:#3a4f7a}\n  .item a{color:#cfe0ff;text-decoration:none}\n  .item small{display:block;margin-top:4px;color:#93a2bf}\n  .pill{display:inline-block;padding:4px 8px;border:1px solid #41527a;border-radius:999px;font-size:12px;color:#cbd8f5;margin-right:6px}\n  .footer{margin-top:18px;color:var(--muted);font-size:12px;text-align:center}\n</style>\n</head>\n<body>\n  <div class=\"wrap\">\n    <header>\n      <div class=\"brand\">\n        <div class=\"badge\" aria-hidden=\"true\"></div>\n        <div>\n          <h1>Media Search · Zen</h1>\n          <div class=\"sub\">Design you can feel — 極簡、靜謐、一次到位的媒體監測搜尋器。</div>\n        </div>\n      </div>\n    </header>\n\n    <section class=\"card grid grid-2\">\n      <div class=\"grid\">\n        <div>\n          <label>關鍵字（活動名稱、品牌名、Hashtag...）</label>\n          <input id=\"kw\" type=\"text\" placeholder=\"例如：ASUS Zenbook 發表會\">\n        </div>\n        <div class=\"row\">\n          <div>\n            <label>開始日期</label>\n            <input id=\"start\" type=\"date\">\n          </div>\n          <div>\n            <label>結束日期</label>\n            <input id=\"end\" type=\"date\">\n          </div>\n        </div>\n        <div>\n          <label>排除詞（以空白分隔，會加上 - 符號）</label>\n          <input id=\"exclude\" type=\"text\" placeholder=\"例如：二手 贊助 廣編\">\n        </div>\n        <div>\n          <label>自訂附加關鍵字（可留空）</label>\n          <input id=\"extra\" type=\"text\" placeholder=\"例如：媒體報導 首發 現場 直擊\">\n        </div>\n\n        <div class=\"divider\"></div>\n\n        <div>\n          <label>網站篩選</label>\n          <div class=\"sites\" id=\"siteList\">\n            <!-- 動態填入 -->\n          </div>\n          <div class=\"row\" style=\"margin-top:10px\">\n            <input id=\"customSite\" type=\"text\" placeholder=\"輸入自訂網域，例如: technews.tw\">\n            <button class=\"btn\" onclick=\"addCustomSite()\">加入自訂網域</button>\n          </div>\n          <div class=\"btns\">\n            <button class=\"btn\" onclick=\"presetTW()\">台灣媒體預設</button>\n            <button class=\"btn\" onclick=\"clearSites()\">清除網站</button>\n          </div>\n        </div>\n\n        <div class=\"divider\"></div>\n\n        <div class=\"btns\">\n          <button class=\"btn primary\" onclick=\"openAll()\">\n            一鍵開分頁（Google、新聞、Bing） <span class=\"dot\"></span>\n          </button>\n          <button class=\"btn\" onclick=\"copyQuery()\">複製搜尋語法</button>\n          <button class=\"btn\" onclick=\"copyAllLinks()\">複製所有搜尋連結</button>\n          <button class=\"btn\" onclick=\"resetForm()\">重設</button>\n        </div>\n\n        <div class=\"hint\">提示：瀏覽器可能會阻擋彈出視窗。若無法開啟多分頁，先允許此頁的彈出視窗或改用「複製連結」。</div>\n      </div>\n\n      <div class=\"grid\">\n        <div>\n          <label>（選填）Google Programmable Search</label>\n          <div class=\"row\">\n            <input id=\"apiKey\" type=\"text\" placeholder=\"API key\">\n            <input id=\"cx\" type=\"text\" placeholder=\"搜尋引擎 ID（cx）\">\n          </div>\n          <div class=\"btns\">\n            <button class=\"btn\" onclick=\"runCSE()\">直接抓結果（JSON）</button>\n            <button class=\"btn\" onclick=\"downloadCSV()\">下載 CSV</button>\n          </div>\n          <div class=\"hint\">說明：若你填入個人的 API key 與 cx，本頁會在瀏覽器端呼叫 CSE API 顯示前 10 筆結果。</div>\n        </div>\n        <div class=\"divider\"></div>\n        <div>\n          <label>產生的搜尋語法</label>\n          <textarea id=\"preview\" readonly placeholder=\"\"></textarea>\n        </div>\n        <div>\n          <label>結果預覽</label>\n          <div id=\"result\" class=\"result\"></div>\n        </div>\n      </div>\n    </section>\n\n    <p class=\"footer\">© Media Search · Zen — 靜與勁並行。No external libraries. Single-file HTML.</p>\n  </div>\n\n<script>\n  // 預設網站清單（可自行調整）\n  const DEFAULT_SITES = [\n    \"udn.com\",\"ettoday.net\",\"cna.com.tw\",\"ltn.com.tw\",\"chinatimes.com\",\n    \"storm.mg\",\"setn.com\",\"tvbs.com.tw\",\"news.yahoo.com\",\"bnext.com.tw\",\n    \"technews.tw\",\"insight.technews.tw\",\"businessweekly.com.tw\",\n    \"nownews.com\",\"mirror-media.com\",\"thenewslens.com\",\n    \"appledaily.com\",\"reuters.com\",\"bloomberg.com\",\"theverge.com\"\n  ];\n\n  const state = {\n    sites: new Set(),\n    results: []\n  };\n\n  function el(id){ return document.getElementById(id); }\n\n  function initSites(list=DEFAULT_SITES){\n    const box = el(\"siteList\");\n    box.innerHTML = \"\";\n    list.forEach(domain=>{\n      const id = \"site-\"+domain.replace(/\\./g,\"-\");\n      const wrap = document.createElement(\"label\");\n      wrap.className = \"chip\";\n      wrap.innerHTML = `\n        <input type=\"checkbox\" id=\"${id}\" data-domain=\"${domain}\">\n        <span>${domain}</span>\n      `;\n      box.appendChild(wrap);\n    });\n  }\n  initSites();\n\n  function presetTW(){\n    state.sites = new Set(DEFAULT_SITES);\n    initSites(DEFAULT_SITES);\n    // 勾選全部\n    document.querySelectorAll(\"#siteList input[type=checkbox]\").forEach(cb=>cb.checked = true);\n    syncPreview();\n  }\n\n  function clearSites(){\n    state.sites.clear();\n    document.querySelectorAll(\"#siteList input[type=checkbox]\").forEach(cb=>cb.checked = false);\n    syncPreview();\n  }\n\n  function addCustomSite(){\n    const v = el(\"customSite\").value.trim();\n    if(!v) return;\n    const cleaned = v.replace(/^https?:\\/\\//,\"\").replace(/\\/.*$/,\"\");\n    if(cleaned){\n      state.sites.add(cleaned);\n      const current = Array.from(new Set([...DEFAULT_SITES, ...state.sites]));\n      initSites(current);\n      // 勾選新加入的\n      const id = \"site-\"+cleaned.replace(/\\./g,\"-\");\n      const cb = document.getElementById(id);\n      if(cb) cb.checked = true;\n      el(\"customSite\").value = \"\";\n      syncPreview();\n    }\n  }\n\n  function getSelectedSites(){\n    const sel = [];\n    document.querySelectorAll(\"#siteList input[type=checkbox]\").forEach(cb=>{\n      if(cb.checked) sel.push(cb.dataset.domain);\n    });\n    return sel;\n  }\n\n  function buildQuery(){\n    const kw = el(\"kw\").value.trim();\n    const extra = el(\"extra\").value.trim();\n    const exclude = el(\"exclude\").value.trim();\n    const start = el(\"start\").value;\n    const end = el(\"end\").value;\n    const sites = getSelectedSites();\n\n    // 核心關鍵字：用引號鎖定活動名稱，額外詞以空白相連\n    let terms = [];\n    if(kw) terms.push(`\"${kw}\"`);\n    if(extra){\n      // 將空白分詞後逐一串接\n      terms.push(extra.split(/\\s+/).map(s=>s).join(\" \"));\n    }\n    if(exclude){\n      exclude.split(/\\s+/).forEach(t=>{\n        if(t) terms.push(`-${t}`);\n      });\n    }\n    if(sites.length){\n      const siteExpr = sites.map(s=>`site:${s}`).join(\" OR \");\n      terms.push(`(${siteExpr})`);\n    }\n    const q = terms.join(\" \").replace(/\\s+/g,\" \").trim();\n\n    // Google 的日期參數\n    let tbs = \"\";\n    if(start || end){\n      const s = start || \"\";\n      const e = end || \"\";\n      tbs = `&tbs=cdr:1,cd_min:${s},cd_max:${e}`;\n    }\n    return { q, tbs };\n  }\n\n  function syncPreview(){\n    const {q} = buildQuery();\n    el(\"preview\").value = q || \"\";\n  }\n\n  // 監看輸入變動以更新預覽\n  [\"kw\",\"extra\",\"exclude\",\"start\",\"end\"].forEach(id=>{\n    el(id).addEventListener(\"input\", syncPreview);\n  });\n  document.addEventListener(\"change\", e=>{\n    if(e.target && e.target.matches(\"#siteList input[type=checkbox]\")) syncPreview();\n  });\n\n  function genLinks(){\n    const {q, tbs} = buildQuery();\n    const g = `https://www.google.com/search?hl=zh-TW&q=${encodeURIComponent(q)}${tbs}`;\n    const gn = `https://www.google.com/search?hl=zh-TW&tbm=nws&q=${encodeURIComponent(q)}${tbs}`;\n    const b = `https://www.bing.com/search?q=${encodeURIComponent(q)}`;\n    const bn = `https://www.bing.com/news/search?q=${encodeURIComponent(q)}&qft=sortbydate%3d\"1\"`;\n    return [g, gn, b, bn];\n  }\n\n  function openAll(){\n    const links = genLinks();\n    links.forEach(u=> window.open(u, \"_blank\"));\n  }\n\n  async function copy(text){\n    try{ await navigator.clipboard.writeText(text); toast(\"已複製\"); }\n    catch(e){ alert(\"複製失敗，請手動複製。\"); }\n  }\n\n  function copyQuery(){\n    const {q} = buildQuery();\n    if(!q) return;\n    copy(q);\n  }\n  function copyAllLinks(){\n    const links = genLinks().join(\"\\n\");\n    copy(links);\n  }\n\n  function resetForm(){\n    [\"kw\",\"extra\",\"exclude\",\"start\",\"end\",\"apiKey\",\"cx\",\"customSite\"].forEach(id=>el(id).value=\"\");\n    clearSites(); el(\"result\").innerHTML = \"\"; el(\"preview\").value = \"\";\n    state.results = [];\n  }\n\n  function toast(msg){\n    const t = document.createElement(\"div\");\n    t.textContent = msg;\n    t.style.position=\"fixed\";\n    t.style.left=\"50%\";\n    t.style.bottom=\"26px\";\n    t.style.transform=\"translateX(-50%)\";\n    t.style.background=\"rgba(15, 23, 42, .9)\";\n    t.style.border=\"1px solid #2b3755\";\n    t.style.padding=\"10px 14px\";\n    t.style.borderRadius=\"10px\";\n    t.style.color=\"var(--ink)\";\n    t.style.boxShadow=\"0 8px 22px #00000066\";\n    document.body.appendChild(t);\n    setTimeout(()=>t.remove(),1300);\n  }\n\n  // 直接呼叫 Google Programmable Search API（可選）\n  async function runCSE(){\n    const key = el(\"apiKey\").value.trim();\n    const cx = el(\"cx\").value.trim();\n    const {q} = buildQuery();\n    if(!key || !cx){ toast(\"請填入 API key 與 cx\"); return; }\n    if(!q){ toast(\"請輸入關鍵字\"); return; }\n    const url = `https://www.googleapis.com/customsearch/v1?key=${encodeURIComponent(key)}&cx=${encodeURIComponent(cx)}&q=${encodeURIComponent(q)}`;\n    el(\"result\").innerHTML = `<div class=\"hint\">查詢中...</div>`;\n    try{\n      const res = await fetch(url);\n      const data = await res.json();\n      const items = data.items || [];\n      state.results = items.map(it=>({\n        title: it.title,\n        link: it.link,\n        snippet: it.snippet || \"\",\n        displayLink: it.displayLink || \"\"\n      }));\n      renderResults();\n      toast(`取得 ${state.results.length} 筆`);\n    }catch(err){\n      el(\"result\").innerHTML = `<div class=\"hint\">發生錯誤，請檢查 key/cx 或配額。</div>`;\n    }\n  }\n\n  function renderResults(){\n    const box = el(\"result\");\n    box.innerHTML = \"\";\n    if(!state.results.length){\n      box.innerHTML = `<div class=\"hint\">尚無結果。可用上方按鈕開啟搜尋分頁，或填入 API key/cx 後直接抓結果。</div>`;\n      return;\n    }\n    state.results.forEach(r=>{\n      const div = document.createElement(\"div\");\n      div.className = \"item\";\n      div.innerHTML = `\n        <a href=\"${r.link}\" target=\"_blank\" rel=\"noopener\">${escapeHtml(r.title)}</a>\n        <small>${escapeHtml(r.displayLink || \"\")}</small>\n        <small>${escapeHtml(r.snippet || \"\")}</small>\n      `;\n      box.appendChild(div);\n    });\n  }\n\n  function escapeHtml(str){\n    return String(str).replace(/[&<>\"']/g, s=>({\n      \"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\"\n    }[s]));\n  }\n\n  function downloadCSV(){\n    if(!state.results.length){ toast(\"沒有結果可匯出\"); return; }\n    const rows = [\n      [\"title\",\"link\",\"source\",\"snippet\"],\n      ...state.results.map(r=>[r.title,r.link,r.displayLink,r.snippet])\n    ];\n    const csv = rows.map(r=>r.map(cell=>{\n      const t = String(cell ?? \"\");\n      // 簡單 CSV 轉義\n      return /[\",\\n]/.test(t) ? `\"${t.replace(/\"/g,'\"\"')}\"` : t;\n    }).join(\",\")).join(\"\\n\");\n    const blob = new Blob([`\\ufeff${csv}`], {type:\"text/csv;charset=utf-8\"});\n    const a = document.createElement(\"a\");\n    a.href = URL.createObjectURL(blob);\n    a.download = \"media-search.csv\";\n    document.body.appendChild(a); a.click(); a.remove();\n  }\n\n  // 預先同步一次\n  syncPreview();\n</script>\n</body>\n</html>\n",
  "createdAt": "2025-08-27T11:02:49.229Z"
}